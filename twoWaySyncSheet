function twoWaySync() {
  // ЁЯз╛ ржжрзБржЯрж┐ рж╢рж┐ржЯрзЗрж░ ID ржмрж╕рж╛ржУ
  var sheetAId = '1dkxyRi5X8V5ynvQ9U9vMqbG6MsHAHQNjDbCu5jutKyY';  // ржЙржжрж╛рж╣рж░ржг: Source 1
  var sheetBId = '13fLUzrq4xKpJoRk0IlMtdbo-ulqgBIyFXegR7wPmNX8';  // ржЙржжрж╛рж╣рж░ржг: Source 2

  // ЁЯз╛ рж╢рж┐ржЯрзЗрж░ ржирж╛ржо (ржЯрзНржпрж╛ржмрзЗрж░ ржирж╛ржо)
  var sheetAName = 'Sheet1';
  var sheetBName = 'Sheet1';

  // ЁЯУВ рж╢рж┐ржЯржЧрзБрж▓рзЛ ржУржкрзЗржи ржХрж░рзЛ
  var sheetA = SpreadsheetApp.openById(sheetAId).getSheetByName(sheetAName);
  var sheetB = SpreadsheetApp.openById(sheetBId).getSheetByName(sheetBName);

  // ЁЯУК ржбрзЗржЯрж╛ ржЖржирзЛ
  var dataA = sheetA.getDataRange().getValues();
  var dataB = sheetB.getDataRange().getValues();

  // ЁЯзо рж╕рж░рзНржмрзЛржЪрзНржЪ рж░рзЛ ржУ ржХрж▓рж╛ржо ржмрзЗрж░ ржХрж░рзЛ
  var maxRows = Math.max(dataA.length, dataB.length);
  var maxCols = Math.max(dataA[0].length, dataB[0].length);

  // ЁЯза ржжрзБржЗ ржжрж┐ржХрзЗрж░ рждрзБрж▓ржирж╛ ржХрж░рзЗ рж╕рж┐ржЩрзНржХ ржХрж░рж╛
  var updatedA = false;
  var updatedB = false;

  for (var i = 0; i < maxRows; i++) {
    for (var j = 0; j < maxCols; j++) {
      var valA = (dataA[i] && dataA[i][j]) || '';
      var valB = (dataB[i] && dataB[i][j]) || '';

      // ржпржжрж┐ ржорж╛ржи ржнрж┐ржирзНржи рж╣рзЯ, рждрж╛рж╣рж▓рзЗ ржЖржкржбрзЗржЯ
      if (valA !== valB) {
        if (valA === '' && valB !== '') {
          // Sheet A ржлрж╛ржБржХрж╛, Sheet B рждрзЗ ржорж╛ржи ржЖржЫрзЗ тЖТ A ржЖржкржбрзЗржЯ ржХрж░рзЛ
          if (!dataA[i]) dataA[i] = [];
          dataA[i][j] = valB;
          updatedA = true;
        } else if (valB === '' && valA !== '') {
          // Sheet B ржлрж╛ржБржХрж╛, Sheet A рждрзЗ ржорж╛ржи ржЖржЫрзЗ тЖТ B ржЖржкржбрзЗржЯ ржХрж░рзЛ
          if (!dataB[i]) dataB[i] = [];
          dataB[i][j] = valA;
          updatedB = true;
        } else {
          // ржжрзБржЯрзЛрждрзЗржЗ ржорж╛ржи ржЖржЫрзЗ ржХрж┐ржирзНрждрзБ ржЖрж▓рж╛ржжрж╛ тЖТ Sheet B ржПрж░ ржорж╛ржиржХрзЗ Sheet A ржПрж░ рж╕рж╛ржерзЗ ржорж┐рж▓рж╛ржУ
          dataB[i][j] = valA;
          updatedB = true;
        }
      }
    }
  }

  // тЬЕ ржЖржкржбрзЗржЯржЧрзБрж▓рзЛ рж▓рж┐ржЦрзЗ ржжрж╛ржУ
  if (updatedA) {
    sheetA.clearContents();
    sheetA.getRange(1, 1, dataA.length, dataA[0].length).setValues(dataA);
  }

  if (updatedB) {
    sheetB.clearContents();
    sheetB.getRange(1, 1, dataB.length, dataB[0].length).setValues(dataB);
  }

  Logger.log("тЬЕ Two-way sync completed successfully!");
}

